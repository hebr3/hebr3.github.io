<!DOCTYPE html>
<html lang="en" class="gridded">
    <head>
        <meta charset="utf-8">
        <meta name="generator" content="Racket 6.8 + Pollen 1.1.1266.881">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>20% Project - ProjectEuler #27</title>
        <link rel="stylesheet" href="/styles.css" media="screen">
                <script type="text/javascript"
                  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
                </script>
                <script type="text/x-mathjax-config">
                  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
                </script>
                <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
                <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
                <script>hljs.initHighlightingOnLoad()</script>
    </head>
    <body>
        <header class="main">
            <p><a href="/index.html" class="home">Henry Brooks</a></p>
            <nav>
                <ul>
                    <li><a href="/topics.html">Topics</a></li>
                    <li><a href="/about.html">About</a></li>
                </ul>
            </nav>
        </header>

        <article>
            <header>
                <h1>20% Project - ProjectEuler #27</h1>
                <p>Scribbled <a href="/posts\20-project-project-euler-27.html" class="permlink"><time datetime="2015-04-11">Saturday, April 11th, 2015</time></a>

                &middot;&nbsp;<a class="pdf" href="20-project-project-euler-27.pdf">PDF</a>&nbsp;
                &middot;&nbsp;<a href="/posts\20-project-project-euler-27.pollen.html" class="source-link">&loz;&nbsp;Pollen&nbsp;Source</a></p>
                <ul>
                <li><a href="/topics.html#Teaching Credential">#Teaching Credential</a></li><li><a href="/topics.html#20% Project">#20% Project</a></li><li><a href="/topics.html#Project Euler">#Project Euler</a></li></ul>
            </header>

<p>Euler discovered the remarkable quadratic formula:</p><p><mathjax>$n^2 + n + 41$</mathjax></p><p>It turns out that the formula will produce <mathjax>$40$</mathjax> primes for the consecutive values <mathjax>$n = 0$</mathjax> to <mathjax>$39$</mathjax>. However, when <mathjax>$n = 40$</mathjax>, <mathjax>$40^2 + 40 + 41 = 40(40 + 1) + 41$</mathjax> is divisible by <mathjax>$41$</mathjax>, and certainly when <mathjax>$n = 41, 41^2 + 41 + 41$</mathjax> is clearly divisible by <mathjax>$41$</mathjax>.</p><p>The incredible formula <mathjax>$n^2 − 79n + 1601$</mathjax> was discovered, which produces <mathjax>$80$</mathjax> primes for the consecutive values <mathjax>$n = 0$</mathjax> to <mathjax>$79$</mathjax>. The product of the coefficients, <mathjax>$−79$</mathjax> and <mathjax>$1,601$</mathjax>, is <mathjax>$−126,479$</mathjax>.</p><p>Considering quadratics of the form:</p><p><mathjax>$n^2 + an + b$</mathjax>, where <mathjax>$|a| &lt; 1,000$</mathjax> and <mathjax>$|b| &lt; 1,000$</mathjax> where <mathjax>$|n|$</mathjax> is the modulus/absolute value of <mathjax>$n$</mathjax> e.g. <mathjax>$|11| = 11$</mathjax> and <mathjax>$|−4| = 4$</mathjax></p><p>Find the product of the coefficients, a and b, for the quadratic expression that produces the maximum number of primes for consecutive values of n, starting with n = 0.</p><p><a href="https://projecteuler.net/problem=27">Project Euler</a></p><p>Initially I planned to tackle this problem from a strictly brute force perspective. I have found that working on a simple solution to a problem usually gives me insights to more elegant solutions.</p><p>Therefore I figured that the most straight forward and inelegant method was to produce a 1999 by 1999 array with individual elements of the array corresponding to the maximum number of consecutive primes generated by that combination of a and b.</p><p>Thus the initial element of the array in position |1,1| would be the maximum number of consecutive primes generated by n2 + (-999)n + (-999), and the final position of |1999,1999| would be n2 + (999)n + (999).</p><p>With this plan in mind I tried to think up a quick way to calculate the maximum number of consecutive primes for a given <bold>a</bold> and <bold>b</bold>.</p><p>I started by having Mathematica generate the first 101 values from the example given in the problem by using a=1 and b=41.</p><figure><img src="/posts/img/ProjectEuler27a.png" alt=""/><figcaption></figcaption></figure><p>I then used <bold>PrimeQ</bold> to test whether each value was prime.</p><figure><img src="/posts/img/ProjectEuler27b.png" alt=""/><figcaption></figcaption></figure><p>Then used <bold>Boole</bold> to convert these true false values to 0’s and 1’s.</p><figure><img src="/posts/img/ProjectEuler27c.png" alt=""/><figcaption></figcaption></figure><p>And finally <bold>FirstPosition</bold> to find the first false in the list.</p><figure><img src="/posts/img/ProjectEuler27d.png" alt=""/><figcaption></figcaption></figure><p>Note that the answer of 41 corresponds to the 39 primes listed in the example since this method doesn’t count the primes from 0-39 but from 1-40 and it found a non-Prime number in position 41.</p><p>So...</p><p>This method is horribly inelegant, however it does work so it’s time to see if I can use this method to generate the <mathjax>$1,999$</mathjax> by <mathjax>$1999$</mathjax> array I initially planned for.</p><p>I begin by trying my method on a smaller array and seeing if it would work at all.</p><figure><img src="/posts/img/ProjectEuler27e.png" alt=""/><figcaption></figcaption></figure><p>Note that this entry should be much larger as it displays a <mathjax>$51×51$</mathjax> array of values.</p><p>To find the maximum element of this array I then use the <bold>Position</bold> and <bold>Max</bold> commands. <bold>Position</bold> gives the location in an array of a specified value, and <bold>Max</bold> gives the largest element of the array.</p><figure><img src="/posts/img/ProjectEuler27f.png" alt=""/><figcaption></figcaption></figure><figure><img src="/posts/img/ProjectEuler27g.png" alt=""/><figcaption></figcaption></figure><p>Since we are counting up from 0 we have now found that the Maximum number of consecutive primes is generated with <bold>a</bold>=1 and <bold>b</bold>=41 which matches the example.</p><p>One area of concern going forward is that it takes <mathjax>$0.655,204$</mathjax> secs for Mathematica to create the <mathjax>$51×51$</mathjax> array I used above. Since a <mathjax>$1,999×1,999$</mathjax> array is almost <mathjax>$1,600%$</mathjax> larger than a <mathjax>$50×50$</mathjax> array, that means that generating a <mathjax>$1999×1999$</mathjax> array should take at least <mathjax>$17$</mathjax> minutes and <mathjax>$28.33$</mathjax> second. Most likely longer considering that the edges of the array will be dealing with <bold>a</bold> and <bold>b</bold> values greater than <mathjax>$900$</mathjax>.</p><p>Still I have free time and I’m not paying for processing time so we might as well go forward and see how long it takes.</p><figure><img src="/posts/img/ProjectEuler27h.png" alt=""/><figcaption></figcaption></figure><p>So <mathjax>$21$</mathjax> minutes and <mathjax>$14$</mathjax> seconds later we have our array and can try to find the Maximum number of consecutive primes.</p><figure><img src="/posts/img/ProjectEuler27i.png" alt=""/><figcaption></figcaption></figure><p>And we have a max at <mathjax>$|939,1971|$</mathjax>, so <mathjax>$939-1000=-61$</mathjax> and <mathjax>$1971-1000=971$</mathjax> are are <bold>a</bold> and <bold>b</bold> values.</p><p><mathjax>$a*b=-61*971=-59231$</mathjax></p><p>And we thus have our answer for Problem 27.</p><p>Now we can focus on improving this process.</p><p>We could start by recognizing that <bold>b</bold> has to be a prime number. It was only after I had finished this problem that I realized that since n starts at 0 the first element will always be 0*0 + a*0 + b. Since there are 168 primes less than 1000 that means I only needed 168 rows instead of 1999.</p><p>A <mathjax>$1999×168$</mathjax> array is <mathjax>$8.4%$</mathjax> the size of a <mathjax>$1999×1999$</mathjax> array and only took Mathematica <mathjax>$1$</mathjax> minute and <mathjax>$56$</mathjax> seconds to calculate.</p><figure><img src="/posts/img/ProjectEuler27j.png" alt=""/><figcaption></figcaption></figure><p>A larger time sink is that I am actually calculating out the first <mathjax>$100 n$</mathjax> values for every combination of <bold>a</bold> and<bold>b</bold>tested. Thus even if the second value calculated is non-Prime I still waste time evaluating the next 98 values.</p><p>Using the following code I can just check if the <mathjax>$n$</mathjax> values are prime and stop when a non-Prime is found.</p><figure><img src="/posts/img/ProjectEuler27k.png" alt=""/><figcaption></figcaption></figure><p>To better understand how much time this saves, I calculated a <mathjax>$50×50$</mathjax> array using the old method and the new method and had Mathematica generate an <bold>ArrayPlot</bold> to save space.</p><figure><img src="/posts/img/ProjectEuler27l.png" alt=""/><figcaption></figcaption></figure><p>The second method took <mathjax>$6.1%$</mathjax> of the time taken by the first method.</p><p>Using both methods together the entire process of generating the <mathjax>$1999×168$</mathjax> array takes <mathjax>$10$</mathjax> seconds.</p><figure><img src="/posts/img/ProjectEuler27m.png" alt=""/><figcaption></figcaption></figure><p>I haven’t looked into it, but I suspect that I could similarly shave a couple of seconds off of the total running time by finding some trick for picking a values.</p><p>Conclusion</p><p>I started by creating a rather inelegant method for finding the number of consecutive primes generated on a <mathjax>$1999×1999$</mathjax> matrix. This method took <mathjax>$21$</mathjax> minutes and <mathjax>$14$</mathjax> seconds.</p><p>I next examined the problem more closely and found areas that could be refined so that I found that same solution in <mathjax>$10$</mathjax> seconds.</p><p>I’m confident that the majority of the improvement in performance came from optimizing the operation that found the number of consecutive primes.</p><figure><img src="/posts/img/ProjectEuler27n.png" alt=""/><figcaption></figcaption></figure><p>Using the above code I found that <mathjax>$280,607$</mathjax> times the second number tested was non-Prime. Since there are only <mathjax>$336,000$</mathjax> entries in the array that means that <mathjax>$83.5%$</mathjax> of the time while generating the original array I could have stopped after calculating the second value.</p><p>This was a longer write up than I originally expected, but it was a rather involved problem that benefited greatly from optimization.</p>
        </article>
        <footer class="main">
            <ul>
                <li><a href="mailto:brook057@cougars.csusm.edu">brook057@cougars.csusm.edu</a></li>
                <li>Source code on <a href="https://github.com/hebr3/hebr3.github.io"> <b>Github</b></a></li>
            </ul>
        </footer>
    </body>
</html>